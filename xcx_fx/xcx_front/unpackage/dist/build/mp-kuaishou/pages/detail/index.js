(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/index"],{"05c9":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("3841")),r=a(n("39da"));a(n("610d"));function a(t){return t&&t.__esModule?t:{default:t}}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(L){s=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var r=e&&e.prototype instanceof f?e:f,a=Object.create(r.prototype),i=new x(o||[]);return a._invoke=function(t,e,n){var o="suspendedStart";return function(r,a){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===r)throw a;return P()}for(n.method=r,n.arg=a;;){var i=n.delegate;if(i){var c=I(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(t,e,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(L){return{type:"throw",arg:L}}}t.wrap=l;var d={};function f(){}function h(){}function p(){}var v={};s(v,r,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(T([])));w&&w!==e&&n.call(w,r)&&(v=w);var y=p.prototype=f.prototype=Object.create(v);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var o;this._invoke=function(r,a){function i(){return new e((function(o,i){(function o(r,a,i,c){var s=u(t[r],t,a);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,i,c)}),(function(t){o("throw",t,i,c)})):e.resolve(d).then((function(t){l.value=t,i(l)}),(function(t){return o("throw",t,i,c)}))}c(s.arg)})(r,a,o,i)}))}return o=o?o.then(i,i):i()}}function I(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,I(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=u(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var r=o.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,c,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(b.prototype),s(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,o,r,a){void 0===a&&(a=Promise);var i=new b(l(e,n,o,r),a);return t.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},m(y),s(y,c,"Generator"),s(y,r,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var o=e.pop();if(o in t)return n.value=o,n.done=!1,n}return n.done=!0,n}},t.values=T,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return i.type="throw",i.arg=t,e.next=n,o&&(e.method="next",e.arg=void 0),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],i=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function c(t,e,n,o,r,a,i){try{var c=t[a](i),s=c.value}catch(l){return void n(l)}c.done?e(s):Promise.resolve(s).then(o,r)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(t){c(a,o,r,i,s,"next",t)}function s(t){c(a,o,r,i,s,"throw",t)}i(void 0)}))}}var l=getApp(),u=null,d={data:function(){return{id:0,btnsShow:!0,src:"",src2:"",type:0,downloadVisible:!1,img_type:1,selfnterval:null,hasShowChaping:null,selfntervalJili:null,userInfo:{},hasUserInfo:!1,dealCollection:0,canZan:!0,localAdType:1,ad_number:3,free_ad_num:10,openidNeterval:null,adNeterval:null}},onLoad:function(t){this.src=t.src||"",this.src2=t.src2||"",this.id=t.id||0,this.type=t.type||0,this.img_type=t.img_type||1,l.saveAnalysisInfo(2,this.id),console.log(t);var e=this;this.openidNeterval=setInterval((function(){l.globalData.openid&&(e.getUserSystemInfo(),e.checkCollection(),e.checkZan(),clearInterval(e.openidNeterval))}),10),this.selfnterval=setInterval((function(){null!=l.globalData.adInfo&&""!=l.globalData.adInfo.chaping&&(l.globalData.canShowAd,clearInterval(e.selfnterval))}),200),this.selfntervalJili=setInterval((function(){null!=l.globalData.adInfo&&""!=l.globalData.adInfo.jili&&(l.globalData.canShowAd&&(u=ks.createRewardedVideoAd({type:100011056,unitId:parseInt(l.globalData.adInfo.jili)}),u.onLoad((function(){console.log("onLoad event emit")})),u.onError((function(t){var e=t.errCode;console.log("onError event emit",e)})),u.onClose((function(t){var n=t.isEnded;console.log("onClose event emit",n),1==n?e.afterAdOperate():e.stopAdOperate()}))),clearInterval(e.selfntervalJili))}),200),this.adNeterval=setInterval((function(){l.globalData.adRequestRes&&(e.ad_number=l.globalData.de_ad_number,e.free_ad_num=l.globalData.free_ad_num,clearInterval(e.adNeterval))}),10)},onUnload:function(){u.destroy(),u=null},onShow:function(){},methods:{afterAdOperate:function(){this.downloadStart(),l.dealPp(this.id,this.userInfo.nickName,this.userInfo.avatarUrl),l.addAdLog(),l.saveAnalysisInfo(5,this.id)},stopAdOperate:function(){l.saveAnalysisInfo(6,this.id),t.showToast({title:"请看完广告才能下载",icon:"none"})},getUserSystemInfo:function(){var e=this;return s(i().mark((function n(){var a,c;return i().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e,n.next=3,(0,r.default)({url:"".concat(o.default.API,"api/user/getInfo"),method:"POST",data:{openid:l.globalData.openid,platform:l.globalData.projectId}});case 3:c=n.sent,0===c.error_code?(a.hasUserInfo=!0,a.userInfo=c.data):t.login({success:function(e){a.code=e.code,t.getUserInfo({withCredentials:!0,success:function(t){l.saveUserInfo(t.userInfo.avatarUrl,t.userInfo.nickName),a.userInfo=t.userInfo,a.hasUserInfo=!0},fail:function(t){a.get_openSetting()}})}});case 5:case"end":return n.stop()}}),n)})))()},addDownCount:function(){var t=this;return s(i().mark((function e(){return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,r.default)({url:"".concat(o.default.API,"api/w/addDownCount"),method:"POST",data:{id:t.id}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))()},checkCollection:function(){var t=this;return s(i().mark((function e(){var n;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!l.globalData.openid){e.next=5;break}return e.next=3,(0,r.default)({url:"".concat(o.default.API,"api/w/checkCollection"),method:"POST",data:{id:t.id,openid:l.globalData.openid,platform:l.globalData.projectId}});case 3:n=e.sent,0===n.error_code?t.dealCollection=2:t.dealCollection=1;case 5:case"end":return e.stop()}}),e)})))()},doCollection:function(){var e=this;return s(i().mark((function n(){var a;return i().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!l.globalData.openid||0==e.dealCollection){n.next=12;break}return n.next=3,(0,r.default)({url:"".concat(o.default.API,"api/w/doCollection"),method:"POST",data:{id:e.id,openid:l.globalData.openid,platform:l.globalData.projectId,status:e.dealCollection,type:e.img_type}});case 3:if(a=n.sent,0!=a.error_code){n.next=9;break}return e.dealCollection=1==e.dealCollection?2:1,n.abrupt("return",t.showToast({title:"操作成功",icon:"none"}));case 9:return n.abrupt("return",t.showToast({title:"操作失败",icon:"none"}));case 10:n.next=13;break;case 12:return n.abrupt("return",t.showToast({title:"请稍后再试",icon:"none"}));case 13:case"end":return n.stop()}}),n)})))()},checkZan:function(){var t=this;return s(i().mark((function e(){var n;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!l.globalData.openid){e.next=5;break}return e.next=3,(0,r.default)({url:"".concat(o.default.API,"api/w/checkZan"),method:"POST",data:{id:t.id,openid:l.globalData.openid,platform:l.globalData.projectId}});case 3:n=e.sent,0!==n.error_code?t.canZan=!0:t.canZan=!1;case 5:case"end":return e.stop()}}),e)})))()},doZan:function(){var e=this;return s(i().mark((function n(){var a;return i().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!l.globalData.openid||0==e.dealCollection){n.next=12;break}return n.next=3,(0,r.default)({url:"".concat(o.default.API,"api/w/doZan"),method:"POST",data:{id:e.id,openid:l.globalData.openid,platform:l.globalData.projectId,status:e.dealCollection}});case 3:if(a=n.sent,0!=a.error_code){n.next=9;break}return e.canZan=!1,n.abrupt("return",t.showToast({title:"操作成功",icon:"none"}));case 9:return n.abrupt("return",t.showToast({title:"操作失败",icon:"none"}));case 10:n.next=13;break;case 12:return n.abrupt("return",t.showToast({title:"请稍后再试",icon:"none"}));case 13:case"end":return n.stop()}}),n)})))()},showRewardedVideoAd:function(){var e=this;u.show().catch((function(){u.load().then((function(){return u.show()})).catch((function(n){l.saveAnalysisInfo(7,e.id),t.showToast({title:"广告显示失败",icon:"none"})}))}))},get_openSetting:function(){var e=this;t.showModal({title:"温馨提示",content:"为了更好的体验小程序,请先授权~",showCancel:!1,success:function(n){t.openSetting({success:function(n){n.authSetting["scope.userInfo"]?t.login({success:function(n){e.code=n.code,t.getUserInfo({withCredentials:!0,success:function(t){e.downloadShow(),e.hasUserInfo=!0,e.userInfo=t.userInfo,l.saveUserInfo(t.userInfo.avatarUrl,t.userInfo.nickName)}})}}):t.showToast({title:"请授权更好体验小程序",icon:"none"})}})}})},toggleBtns:function(){this.btnsShow=!this.btnsShow},backAction:function(){t.navigateBack({fail:function(e){console.log(e),console.log("navigateBack调用失败"),t.switchTab({url:"/pages/index/index"})}})},downloadShow:function(){var t=this;this.authPhoto((function(){t.downloadAction(0),console.log("授权相册处理")}))},downloadHide:function(){this.downloadVisible=!1},downloadAction:function(e){var n=this;if(1==e)this.localAdType=1,t.showLoading({title:"正在下载中..."}),setTimeout((function(){n.downloadStart()}),1500),l.saveAnalysisInfo(4,n.id);else if(l.globalData.canShowAd&&l.globalData.illegal_ad_number<l.globalData.ad_number)n.localAdType=0,n.showRewardedVideoAd(),l.saveAnalysisInfo(3,n.id);else{if(!(l.globalData.illfree_ad_num<l.globalData.free_ad_num))return t.showToast({title:"今日可下载次数用完",icon:"none"});n.localAdType=0,n.downloadStart(),l.addFreeAdLog()}},downloadStart:function(){t.showLoading({title:"正在下载中..."}),console.log(this.localAdType);var e=this;e.downloadHide(),1==this.type&&0==this.localAdType?t.downloadFile({url:this.src,success:function(n){console.log(n),200===n.statusCode&&t.saveVideoToPhotosAlbum({filePath:n.tempFilePath,success:function(){l.saveAnalysisInfo(8,e.id),t.hideLoading(),t.showToast({title:"保存成功",icon:"success",duration:1e3})},fail:function(n){t.hideLoading(),console.log(n),"saveImageToPhotosAlbum:fail:auth denied"===n.errMsg||"saveImageToPhotosAlbum:fail auth deny"===n.errMsg||"saveImageToPhotosAlbum:fail authorize no response"===n.errMsg?(t.showToast({title:"需要开启相册权限",icon:"success",duration:1e3}),e.authPhoto((function(){return e.downloadAction(e.localAdType)}))):t.showToast({title:"怎么不保存啦",icon:"success",duration:1e3})}})},fail:function(e){t.showToast("保存失败！")}}):t.getImageInfo({src:0==this.localAdType?this.src:this.src2,success:function(n){t.saveImageToPhotosAlbum({filePath:n.path,success:function(){l.saveAnalysisInfo(8,e.id),t.hideLoading(),t.showToast({title:"保存成功",icon:"success",duration:1e3})},fail:function(n){t.hideLoading(),"saveImageToPhotosAlbum:fail:auth denied"===n.errMsg||"saveImageToPhotosAlbum:fail auth deny"===n.errMsg||"saveImageToPhotosAlbum:fail authorize no response"===n.errMsg?(t.showToast({title:"需要开启相册权限",icon:"success",duration:1e3}),e.authPhoto((function(){return e.downloadAction(e.localAdType)}))):t.showToast({title:"怎么不保存啦",icon:"success",duration:1e3})}})},fail:function(e){t.hideLoading(),t.showModal({title:"提示",content:"当前客户端版本过低，无法使用该功能，请升级客户端"})}})},authPhoto:function(e){t.getSetting({success:function(n){console.log(n),n.authSetting["scope.writePhotosAlbum"]?e&&e():t.authorize({scope:"scope.writePhotosAlbum",success:function(){e&&e()},fail:function(n){console.log(n),t.openSetting({success:function(n){1==n.authSetting["scope.writePhotosAlbum"]?e&&e():t.showToast({title:"授权权限才能下载",icon:"none"})},fail:function(e){console.log(e),t.showToast({title:"请到设置里开启相册权限",icon:"none"})}})}})},fail:function(e){t.showModal({title:"提示",content:"授权权限才能下载！"})}})}},onShareAppMessage:function(t){console.log("src=".concat(this.src,"&src2=").concat(this.src2,"&id=").concat(this.id,"&type=").concat(this.type,"&img_type=").concat(this.img_type));var e="/pages/detail/index?src=".concat(this.src,"&src2=").concat(this.src2,"&id=").concat(this.id,"&type=").concat(this.type,"&img_type=").concat(this.img_type);return{title:l.globalData.shareInfo.share_title,desc:l.globalData.shareInfo.share_desc,path:e}}};e.default=d}).call(this,n("c5f9")["default"])},"06cf":function(t,e,n){"use strict";var o=n("9c51"),r=n.n(o);r.a},"0eb2":function(t,e,n){"use strict";n.r(e);var o=n("a17c"),r=n("bae9");for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("e272"),n("06cf");var i=n("f0c5"),c=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,"402377af",null,!1,o["a"],void 0);e["default"]=c.exports},"5c90":function(t,e,n){"use strict";(function(t,e){n("2943");r(n("66fd"));var o=r(n("0eb2"));function r(t){return t&&t.__esModule?t:{default:t}}t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("c5f9")["default"],n("c5f9")["createPage"])},"691e":function(t,e,n){},"9c51":function(t,e,n){},a17c:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},r=[]},bae9:function(t,e,n){"use strict";n.r(e);var o=n("05c9"),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},e272:function(t,e,n){"use strict";var o=n("691e"),r=n.n(o);r.a}},[["5c90","common/runtime","common/vendor"]]]);