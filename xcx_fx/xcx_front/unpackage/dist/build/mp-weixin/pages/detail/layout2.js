(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/layout2"],{2289:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(o("a34a")),a=c(o("3841")),i=c(o("610d")),s=c(o("39da"));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,o,n,a,i,s){try{var c=e[i](s),l=c.value}catch(r){return void o(r)}c.done?t(l):Promise.resolve(l).then(n,a)}function r(e){return function(){var t=this,o=arguments;return new Promise((function(n,a){var i=e.apply(t,o);function s(e){l(i,n,a,s,c,"next",e)}function c(e){l(i,n,a,s,c,"throw",e)}s(void 0)}))}}var d=function(){o.e("components/alert").then(function(){return resolve(o("c70d"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("pages/detail/yinliu").then(function(){return resolve(o("5775"))}.bind(null,o)).catch(o.oe)},f=getApp(),h=null,g=null,p={components:{Yinliu:u,Alert:d},data:function(){return{id:0,src:"",src2:"",type:0,img_type:1,expression_video:"",click_type:1,expression_show_video:0,userInfo:{},hasUserInfo:!1,localAdType:0,windowWidth:i.default.systemInfo().windowWidth,list:[],isLoading:!1,loadOver:!1,page:1,ad_number:0,free_ad_num:0,selfnterval:null,hasShowChaping:null,selfntervalJili:null,openidNeterval:null,adNeterval:null,yinliuVisible:!1}},onLoad:function(t){console.log(t),this.src=t.src||"",this.src2=t.src2||"",this.id=t.id||0,this.type=t.type||0,this.img_type=t.img_type||1,this.expression_video=t.e_video||"",this.expression_show_video=t.e_show_v||0,f.saveAnalysisInfo(2,this.id),this.getData();var o=this;this.openidNeterval=setInterval((function(){f.globalData.openid&&(o.getUserSystemInfo(),clearInterval(o.openidNeterval))}),10),this.selfnterval=setInterval((function(){null!=f.globalData.adInfo&&""!=f.globalData.adInfo.chaping&&(f.globalData.canShowAd&&e.createInterstitialAd&&(g=e.createInterstitialAd({adUnitId:f.globalData.adInfo.chaping}),g.onLoad((function(){})),g.onError((function(e){})),g.onClose((function(){clearInterval(o.hasShowChaping),console.log("关闭了插屏")})),console.log("实例化了"),console.log(g)),clearInterval(o.selfnterval))}),200),this.selfntervalJili=setInterval((function(){null!=f.globalData.adInfo&&""!=f.globalData.adInfo.jili&&(f.globalData.canShowAd&&e.createRewardedVideoAd&&(console.log(f.globalData.adInfo.jili),h=e.createRewardedVideoAd({adUnitId:f.globalData.adInfo.jili}),h.onLoad((function(){})),h.onError((function(e){})),h.onClose((function(e){console.log("videoAd onClose",e),e.isEnded?o.afterAdOperate():o.stopAdOperate()}))),clearInterval(o.selfntervalJili))}),200),this.adNeterval=setInterval((function(){f.globalData.adRequestRes&&(o.ad_number=f.globalData.de_ad_number,o.free_ad_num=f.globalData.free_ad_num,clearInterval(o.adNeterval))}),10)},onUnload:function(){},onShow:function(){this.hasShowChaping=setInterval((function(){g&&g.show().catch((function(e){console.error(e)}))}),300)},methods:{redirectKefu:function(){},changeWallpaper:function(e,t,o,n,a,i){this.src=e,this.src2=n,this.id=t,this.expression_show_video=a,this.expression_video=i},afterAdOperate:function(){this.downloadStart(),f.dealPp(this.id,this.userInfo.nickName,this.userInfo.avatarUrl),f.addAdLog(),f.saveAnalysisInfo(5,this.id)},stopAdOperate:function(){f.saveAnalysisInfo(6,this.id),e.showToast({title:"请看完广告才能下载",icon:"none"})},getUserProfile:function(t){var o=this;e.getUserProfile({desc:"用于完善会员资料",success:function(e){o.userInfo=e.userInfo,o.hasUserInfo=!0,f.saveUserInfo(e.userInfo.avatarUrl,e.userInfo.nickName),console.log(o.userInfo),o.changeDownLoadType(1)},fail:function(){e.showToast({title:"请授权更好体验小程序",icon:"none"})}})},getData:function(){var e=this;return r(n.default.mark((function t(){var o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,s.default)({url:"".concat(a.default.API,"api/w/index/wapplaper/list"),method:"POST",data:{type:e.img_type,page:e.page,wallpaper_id:e.id}});case 2:o=t.sent,e.isLoading=!1,0===o.error_code&&(e.list=e.list.concat(o.data.data||[]),o.data.current_page>=o.data.last_page&&(e.loadOver=!0));case 5:case"end":return t.stop()}}),t)})))()},loadMore:function(){this.page++,this.getData()},navigateToDetail:function(t,o,n,a,i){e.navigateTo({url:"/pages/detail/index?src=".concat(t,"&type=").concat(i,"&id=").concat(o,"&img_type=").concat(n,"&src2=").concat(a)})},openStatement:function(){this.$refs.alert.show()},getUserSystemInfo:function(){var e=this;return r(n.default.mark((function t(){var o,i;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,(0,s.default)({url:"".concat(a.default.API,"api/user/getInfo"),method:"POST",data:{openid:f.globalData.openid,platform:f.globalData.projectId}});case 3:i=t.sent,0===i.error_code&&(o.hasUserInfo=!0,o.userInfo=i.data);case 5:case"end":return t.stop()}}),t)})))()},get_openSetting:function(){var t=this;e.showModal({title:"温馨提示",content:"为了更好的体验小程序,请先授权~",showCancel:!1,success:function(o){e.openSetting({success:function(o){o.authSetting["scope.userInfo"]?e.login({success:function(o){t.code=o.code,e.getUserInfo({withCredentials:!0,success:function(e){t.downloadShow(),t.hasUserInfo=!0,t.userInfo=e.userInfo,f.saveUserInfo(e.userInfo.avatarUrl,e.userInfo.nickName)}})}}):e.showToast({title:"请授权更好体验小程序",icon:"none"})}})}})},showRewardedVideoAd:function(){var t=this;h.show().catch((function(){h.load().then((function(){return h.show()})).catch((function(o){f.saveAnalysisInfo(7,t.id),e.showToast({title:"广告显示失败",icon:"none"})}))}))},changeDownLoadType:function(e){this.click_type=e,this.downloadShow()},downloadShow:function(){var e=this;this.authPhoto((function(){e.downloadAction(0)}))},downloadAction:function(t){var o=this;if(f.globalData.canShowAd&&f.globalData.illegal_ad_number<f.globalData.ad_number)o.localAdType=0,o.showRewardedVideoAd(),f.saveAnalysisInfo(3,o.id);else{if(!(f.globalData.illfree_ad_num<f.globalData.free_ad_num))return e.showToast({title:"今日可下载次数用完",icon:"none"});o.localAdType=0,o.downloadStart(),f.addFreeAdLog()}},downloadStart:function(){e.showLoading({title:"正在下载中..."});var t=this;2==this.click_type?e.downloadFile({url:this.expression_video,success:function(o){console.log(o),200===o.statusCode&&e.saveVideoToPhotosAlbum({filePath:o.tempFilePath,success:function(){f.saveAnalysisInfo(8,t.id),e.hideLoading(),e.showToast({title:"保存成功",icon:"success",duration:1e3}),t.yinliuToggle(!0)},fail:function(o){console.log(o),e.hideLoading(),"saveImageToPhotosAlbum:fail:auth denied"===o.errMsg||"saveImageToPhotosAlbum:fail auth deny"===o.errMsg||"saveImageToPhotosAlbum:fail authorize no response"===o.errMsg?(e.showToast({title:"需要开启相册权限",icon:"success",duration:1e3}),t.authPhoto((function(){return t.downloadAction(t.localAdType)}))):e.showToast({title:"怎么不保存啦",icon:"success",duration:1e3})}})},fail:function(t){e.hideLoading(),e.showToast("保存失败！")}}):e.getImageInfo({src:this.src,success:function(o){e.saveImageToPhotosAlbum({filePath:o.path,success:function(){f.saveAnalysisInfo(8,t.id),e.hideLoading(),e.showToast({title:"保存成功",icon:"success",duration:1e3})},fail:function(o){e.hideLoading(),"saveImageToPhotosAlbum:fail:auth denied"===o.errMsg||"saveImageToPhotosAlbum:fail auth deny"===o.errMsg||"saveImageToPhotosAlbum:fail authorize no response"===o.errMsg?(e.showToast({title:"需要开启相册权限",icon:"success",duration:1e3}),t.authPhoto((function(){return t.downloadAction(t.localAdType)}))):e.showToast({title:"怎么不保存啦",icon:"success",duration:1e3})}})},fail:function(t){e.hideLoading(),e.showModal({title:"提示",content:"当前客户端版本过低，无法使用该功能，请升级客户端"})}})},authPhoto:function(t){e.getSetting({success:function(o){console.log(o),o.authSetting["scope.writePhotosAlbum"]?t&&t():e.authorize({scope:"scope.writePhotosAlbum",success:function(){t&&t()},fail:function(o){console.log(o),e.openSetting({success:function(o){1==o.authSetting["scope.writePhotosAlbum"]?t&&t():e.showToast({title:"授权权限才能下载",icon:"none"})},fail:function(t){console.log(t),e.showToast({title:"请到设置里开启相册权限",icon:"none"})}})}})},fail:function(t){e.showModal({title:"提示",content:"授权权限才能下载！"})}})},yinliuToggle:function(e){this.yinliuVisible=e},loadMoreRecom:function(){this.isLoading||this.loadOver||(this.isLoading=!0,this.loadMore())}},onShareAppMessage:function(e){console.log("src=".concat(this.src,"&src2=").concat(this.src2,"&id=").concat(this.id,"&type=").concat(this.type,"&img_type=").concat(this.img_type,"&e_show_v=").concat(this.expression_show_video,"&e_video=").concat(this.expression_video));var t="/pages/detail/layout2?src=".concat(this.src,"&src2=").concat(this.src2,"&id=").concat(this.id,"&type=").concat(this.type,"&img_type=").concat(this.img_type,"&e_show_v=").concat(this.expression_show_video,"&e_video=").concat(this.expression_video);return{title:f.globalData.shareInfo.share_title,desc:f.globalData.shareInfo.share_desc,path:t}}};t.default=p}).call(this,o("543d")["default"])},"70d4":function(e,t,o){"use strict";(function(e){o("2943");n(o("66fd"));var t=n(o("d2bd"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o("543d")["createPage"])},bbba:function(e,t,o){"use strict";var n=o("f466"),a=o.n(n);a.a},d2bd:function(e,t,o){"use strict";o.r(t);var n=o("fa08"),a=o("d7fb");for(var i in a)"default"!==i&&function(e){o.d(t,e,(function(){return a[e]}))}(i);o("bbba");var s,c=o("f0c5"),l=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"3bc2151a",null,!1,n["a"],s);t["default"]=l.exports},d7fb:function(e,t,o){"use strict";o.r(t);var n=o("2289"),a=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},f466:function(e,t,o){},fa08:function(e,t,o){"use strict";var n;o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=[]}},[["70d4","common/runtime","common/vendor"]]]);